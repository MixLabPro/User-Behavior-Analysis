<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·è¡Œä¸ºåˆ†æ - ç»¼åˆæ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        
        .nav-tabs {
            display: flex;
            gap: 10px;
        }
        
        .nav-tab {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            background: #f8f9fa;
            color: #333;
        }
        
        .nav-tab.active {
            background: #667eea;
            color: white;
        }
        
        .nav-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section-title {
            font-size: 28px;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .demo-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .demo-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .demo-card h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 5px;
            display: inline-block;
            text-decoration: none;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .status-panel {
            background: #2d3748;
            color: #68d391;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            height: 300px;
            overflow-y: auto;
            margin: 20px 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .form-group {
            margin: 15px 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #495057;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .interactive-area {
            background: #e9ecef;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .interactive-area:hover {
            background: #dee2e6;
            transform: scale(1.02);
        }
        
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .alert {
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .alert-info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        
        .player-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .aggregator-demo {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .data-preview {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">ğŸ¯ ç”¨æˆ·è¡Œä¸ºåˆ†æ - ç»¼åˆæ¼”ç¤º</div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('tracker')">ğŸ“Š è¡Œä¸ºè¿½è¸ª</button>
                <button class="nav-tab" onclick="showTab('aggregator')">ğŸ”„ æ•°æ®èšåˆ</button>
                <button class="nav-tab" onclick="showTab('player')">ğŸ¬ è¡Œä¸ºå›æ”¾</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- è¡Œä¸ºè¿½è¸ªæ ‡ç­¾é¡µ -->
        <div id="tracker" class="tab-content active">
            <h2 class="section-title">ğŸ“Š ç”¨æˆ·è¡Œä¸ºè¿½è¸ªæ¼”ç¤º</h2>
            
            <div class="alert alert-info">
                <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>è¿™ä¸ªæ¨¡å—ç”¨äºå®æ—¶æ”¶é›†ç”¨æˆ·åœ¨ç½‘é¡µä¸Šçš„å„ç§äº¤äº’è¡Œä¸ºï¼ŒåŒ…æ‹¬é¼ æ ‡ç§»åŠ¨ã€ç‚¹å‡»ã€é”®ç›˜è¾“å…¥ã€æ»šåŠ¨ç­‰ã€‚
            </div>
            
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>ğŸ® è¿½è¸ªæ§åˆ¶</h3>
                    <button class="btn btn-primary" onclick="startTracking()">ğŸš€ å¼€å§‹è¿½è¸ª</button>
                    <button class="btn btn-danger" onclick="stopTracking()">â¹ï¸ åœæ­¢è¿½è¸ª</button>
                    <button class="btn btn-secondary" onclick="showTrackingResults()">ğŸ“‹ æŸ¥çœ‹ç»“æœ</button>
                    <button class="btn btn-secondary" onclick="clearTrackingLog()">ğŸ—‘ï¸ æ¸…é™¤æ—¥å¿—</button>
                </div>
                
                <div class="demo-card">
                    <h3>ğŸ“ˆ å®æ—¶ç»Ÿè®¡</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="clickCount">0</div>
                            <div class="stat-label">ç‚¹å‡»æ¬¡æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="mouseCount">0</div>
                            <div class="stat-label">é¼ æ ‡ç§»åŠ¨</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="scrollCount">0</div>
                            <div class="stat-label">æ»šåŠ¨æ¬¡æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="keyCount">0</div>
                            <div class="stat-label">é”®ç›˜æ´»åŠ¨</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>ğŸ–±ï¸ é¼ æ ‡äº¤äº’æµ‹è¯•</h3>
                    <button class="btn btn-primary" onclick="testClick('æŒ‰é’®A')">ç‚¹å‡»æµ‹è¯• A</button>
                    <button class="btn btn-success" onclick="testClick('æŒ‰é’®B')">ç‚¹å‡»æµ‹è¯• B</button>
                    <button class="btn btn-danger" onclick="testClick('æŒ‰é’®C')">ç‚¹å‡»æµ‹è¯• C</button>
                    <p style="margin-top: 15px;">ç§»åŠ¨é¼ æ ‡åˆ°è¿™ä¸ªåŒºåŸŸæ¥æµ‹è¯•é¼ æ ‡è½¨è¿¹è¿½è¸ªã€‚</p>
                </div>
                
                <div class="demo-card">
                    <h3>âŒ¨ï¸ é”®ç›˜è¾“å…¥æµ‹è¯•</h3>
                    <div class="form-group">
                        <label>æ–‡æœ¬è¾“å…¥ï¼š</label>
                        <input type="text" class="form-control" placeholder="åœ¨è¿™é‡Œè¾“å…¥æ–‡å­—æµ‹è¯•é”®ç›˜è¿½è¸ª...">
                    </div>
                    <div class="form-group">
                        <label>å¤šè¡Œæ–‡æœ¬ï¼š</label>
                        <textarea class="form-control" rows="3" placeholder="è¾“å…¥å¤šè¡Œæ–‡å­—..."></textarea>
                    </div>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>ğŸ“ è¡¨å•äº¤äº’æµ‹è¯•</h3>
                <form id="testForm" onsubmit="handleFormSubmit(event)">
                    <div class="demo-grid">
                        <div class="form-group">
                            <label>å§“åï¼š</label>
                            <input type="text" class="form-control" name="name" required>
                        </div>
                        <div class="form-group">
                            <label>é‚®ç®±ï¼š</label>
                            <input type="email" class="form-control" name="email" required>
                        </div>
                        <div class="form-group">
                            <label>ç±»åˆ«ï¼š</label>
                            <select class="form-control" name="category">
                                <option value="">è¯·é€‰æ‹©</option>
                                <option value="tech">æŠ€æœ¯</option>
                                <option value="design">è®¾è®¡</option>
                                <option value="marketing">è¥é”€</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">æäº¤è¡¨å•</button>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="interactive-area" onclick="testInteraction()">
                <h3>ğŸ¯ äº¤äº’æµ‹è¯•åŒºåŸŸ</h3>
                <p>ç‚¹å‡»è¿™ä¸ªåŒºåŸŸæ¥æµ‹è¯•è§¦æ‘¸å’Œç‚¹å‡»äº‹ä»¶</p>
                <p>ä¹Ÿå¯ä»¥å°è¯•æ»šåŠ¨é¡µé¢æ¥æµ‹è¯•æ»šåŠ¨äº‹ä»¶</p>
            </div>
            
            <div class="status-panel" id="trackingLog">
                <div>ğŸ’¡ æç¤ºï¼šç‚¹å‡»"å¼€å§‹è¿½è¸ª"æŒ‰é’®å¼€å§‹æ”¶é›†ç”¨æˆ·è¡Œä¸ºæ•°æ®...</div>
            </div>
        </div>

        <!-- æ•°æ®èšåˆæ ‡ç­¾é¡µ -->
        <div id="aggregator" class="tab-content">
            <h2 class="section-title">ğŸ”„ æ•°æ®èšåˆå™¨æ¼”ç¤º</h2>
            
            <div class="alert alert-info">
                <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>æ•°æ®èšåˆå™¨ç”¨äºå°†åç«¯æ”¶é›†çš„å•ä¸ªäº‹ä»¶æ•°æ®æ•´ç†æˆå®Œæ•´çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®é›†åˆï¼Œä¾¿äºåˆ†æå’Œå¤„ç†ã€‚
            </div>
            
            <div class="aggregator-demo">
                <h3>ğŸ“Š æ¨¡æ‹Ÿåç«¯æ•°æ®èšåˆ</h3>
                <p>è¿™é‡Œæ¼”ç¤ºå¦‚ä½•å°†åˆ†æ•£çš„äº‹ä»¶æ•°æ®èšåˆæˆå®Œæ•´çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼š</p>
                
                <div class="demo-grid">
                    <div class="demo-card">
                        <h4>1ï¸âƒ£ æ¨¡æ‹Ÿäº‹ä»¶æ•°æ®</h4>
                        <button class="btn btn-primary" onclick="generateMockEvents()">ç”Ÿæˆæ¨¡æ‹Ÿäº‹ä»¶</button>
                        <button class="btn btn-secondary" onclick="clearMockEvents()">æ¸…é™¤äº‹ä»¶</button>
                        <div class="code-block">
                            <strong>äº‹ä»¶æ•°é‡ï¼š</strong><span id="eventCount">0</span>
                        </div>
                    </div>
                    
                    <div class="demo-card">
                        <h4>2ï¸âƒ£ æ•°æ®èšåˆ</h4>
                        <button class="btn btn-success" onclick="aggregateEvents()">èšåˆæ•°æ®</button>
                        <button class="btn btn-secondary" onclick="showAggregatedStats()">æ˜¾ç¤ºç»Ÿè®¡</button>
                        <div class="code-block">
                            <strong>èšåˆçŠ¶æ€ï¼š</strong><span id="aggregateStatus">æœªèšåˆ</span>
                        </div>
                    </div>
                </div>
                
                <div class="demo-card">
                    <h4>ğŸ“‹ åŸå§‹äº‹ä»¶æ•°æ®é¢„è§ˆ</h4>
                    <div class="data-preview" id="rawEventsPreview">
                        æš‚æ— äº‹ä»¶æ•°æ®
                    </div>
                </div>
                
                <div class="demo-card">
                    <h4>ğŸ“Š èšåˆåæ•°æ®é¢„è§ˆ</h4>
                    <div class="data-preview" id="aggregatedDataPreview">
                        æš‚æ— èšåˆæ•°æ®
                    </div>
                </div>
                
                <div class="demo-card">
                    <h4>ğŸ’» ä»£ç ç¤ºä¾‹</h4>
                    <div class="code-block">
<pre>// å¯¼å…¥æ•°æ®èšåˆå™¨
import { aggregateUserBehaviorData } from 'user-behavior-analysis/aggregator';

// èšåˆäº‹ä»¶æ•°æ®
const events = [/* ä»åç«¯è·å–çš„äº‹ä»¶æ•°æ® */];
const sessionId = 'session-123';
const aggregatedData = aggregateUserBehaviorData(events, sessionId);

// é«˜çº§å¤„ç†ï¼ˆåŒ…å«ç»Ÿè®¡ä¿¡æ¯ï¼‰
const processedResult = processUserBehaviorData(events, sessionId, {
    includeStats: true,
    cleanData: true
});</pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¡Œä¸ºå›æ”¾æ ‡ç­¾é¡µ -->
        <div id="player" class="tab-content">
            <h2 class="section-title">ğŸ¬ ç”¨æˆ·è¡Œä¸ºå›æ”¾æ¼”ç¤º</h2>
            
            <div class="alert alert-info">
                <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>è¡Œä¸ºæ’­æ”¾å™¨å¯ä»¥å°†æ”¶é›†åˆ°çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®ä»¥åŠ¨ç”»çš„å½¢å¼é‡æ–°æ’­æ”¾ï¼ŒåŒ…æ‹¬é¼ æ ‡è½¨è¿¹ã€ç‚¹å‡»æ•ˆæœã€æ»šåŠ¨è¡Œä¸ºç­‰ã€‚
            </div>
            
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>ğŸ® æ’­æ”¾æ§åˆ¶</h3>
                    <div class="player-controls">
                        <button class="btn btn-primary" onclick="startRecording()">ğŸ”´ å¼€å§‹å½•åˆ¶</button>
                        <button class="btn btn-danger" onclick="stopRecording()">â¹ï¸ åœæ­¢å½•åˆ¶</button>
                        <button class="btn btn-success" onclick="playRecording()">â–¶ï¸ æ’­æ”¾å›æ”¾</button>
                        <button class="btn btn-secondary" onclick="pausePlayback()">â¸ï¸ æš‚åœæ’­æ”¾</button>
                        <button class="btn btn-secondary" onclick="stopPlayback()">â¹ï¸ åœæ­¢æ’­æ”¾</button>
                        <button class="btn btn-secondary" onclick="destroyPlayer()">ğŸ—‘ï¸ æ¸…é™¤æ’­æ”¾å™¨</button>
                    </div>
                </div>
                
                <div class="demo-card">
                    <h3>âš™ï¸ æ’­æ”¾è®¾ç½®</h3>
                    <div class="form-group">
                        <label>æ’­æ”¾é€Ÿåº¦ï¼š</label>
                        <select class="form-control" id="playbackSpeed" onchange="updatePlayerConfig()">
                            <option value="0.5">0.5x</option>
                            <option value="1" selected>1x</option>
                            <option value="1.5">1.5x</option>
                            <option value="2">2x</option>
                            <option value="3">3x</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="showMouseTrail" checked onchange="updatePlayerConfig()">
                            æ˜¾ç¤ºé¼ æ ‡è½¨è¿¹
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="showClickEffect" checked onchange="updatePlayerConfig()">
                            æ˜¾ç¤ºç‚¹å‡»æ•ˆæœ
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoPlay" onchange="updatePlayerConfig()">
                            è‡ªåŠ¨æ’­æ”¾
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>ğŸ¯ å½•åˆ¶æµ‹è¯•åŒºåŸŸ</h3>
                <p>åœ¨å½•åˆ¶æœŸé—´ï¼Œåœ¨ä¸‹é¢çš„åŒºåŸŸè¿›è¡Œå„ç§æ“ä½œæ¥ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼š</p>
                
                <div class="demo-grid">
                    <div class="interactive-area" onclick="recordTestClick('åŒºåŸŸA')">
                        <h4>æµ‹è¯•åŒºåŸŸ A</h4>
                        <p>ç‚¹å‡»è¿™é‡Œ</p>
                    </div>
                    <div class="interactive-area" onclick="recordTestClick('åŒºåŸŸB')">
                        <h4>æµ‹è¯•åŒºåŸŸ B</h4>
                        <p>æˆ–è€…ç‚¹å‡»è¿™é‡Œ</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>æµ‹è¯•è¾“å…¥æ¡†ï¼š</label>
                    <input type="text" class="form-control" placeholder="åœ¨å½•åˆ¶æ—¶è¾“å…¥æ–‡å­—...">
                </div>
                
                <div class="demo-grid">
                    <button class="btn btn-primary" onclick="recordTestClick('æŒ‰é’®1')">æµ‹è¯•æŒ‰é’® 1</button>
                    <button class="btn btn-success" onclick="recordTestClick('æŒ‰é’®2')">æµ‹è¯•æŒ‰é’® 2</button>
                    <button class="btn btn-danger" onclick="recordTestClick('æŒ‰é’®3')">æµ‹è¯•æŒ‰é’® 3</button>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>ğŸ“Š å½•åˆ¶æ•°æ®ç»Ÿè®¡</h3>
                <div id="recordingStats" class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="recordedClicks">0</div>
                        <div class="stat-label">å½•åˆ¶ç‚¹å‡»</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="recordedMoves">0</div>
                        <div class="stat-label">é¼ æ ‡ç§»åŠ¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="recordedKeys">0</div>
                        <div class="stat-label">é”®ç›˜æ´»åŠ¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="recordingDuration">0s</div>
                        <div class="stat-label">å½•åˆ¶æ—¶é•¿</div>
                    </div>
                </div>
            </div>
            
            <div class="demo-card">
                <h4>ğŸ’» æ’­æ”¾å™¨ä»£ç ç¤ºä¾‹</h4>
                <div class="code-block">
<pre>// å¯¼å…¥æ’­æ”¾å™¨
import userBehaviourPlayer from 'user-behavior-analysis/player';

// é…ç½®æ’­æ”¾å™¨
const config = {
    playbackSpeed: 1.5,
    showMouseTrail: true,
    mouseTrailColor: '#ff4444',
    showClickEffect: true,
    autoPlay: true
};

// åŠ è½½å¹¶æ’­æ”¾æ•°æ®
const trackingData = userBehaviour.showResult();
userBehaviourPlayer.load(trackingData, config);</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥åº“æ–‡ä»¶ -->
    <script src="../dist/userBehaviour.js"></script>
    <script src="../dist/aggregateUserBehaviorData.js"></script>
    <script src="../dist/userBehaviourPlayer.js"></script>

    <script>
        // å…¨å±€å˜é‡
        let isTracking = false;
        let isRecording = false;
        let currentTrackingData = null;
        let currentRecordingData = null;
        let mockEvents = [];
        let aggregatedData = null;
        let currentPlayer = null;
        
        // æ ‡ç­¾é¡µåˆ‡æ¢
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾æŒ‰é’®çš„æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»å¯¹åº”çš„æ ‡ç­¾æŒ‰é’®
            event.target.classList.add('active');
        }
        
        // ==================== è¡Œä¸ºè¿½è¸ªåŠŸèƒ½ ====================
        
        function startTracking() {
            if (!isTracking) {
                userBehaviour.config({
                    userInfo: true,
                    clicks: true,
                    mouseMovement: true,
                    mouseMovementInterval: 0.5,
                    mouseScroll: true,
                    timeCount: true,
                    clearAfterProcess: false,
                    processTime: 2,
                    windowResize: true,
                    visibilitychange: true,
                    keyboardActivity: true,
                    pageNavigation: true,
                    formInteractions: true,
                    touchEvents: true,
                    audioVideoInteraction: true,
                    processData: function(results) {
                        currentTrackingData = results;
                        updateTrackingStats(results);
                        logTrackingActivity('ğŸ“Š æ•°æ®å¤„ç†å®Œæˆ', results);
                    }
                });
                
                userBehaviour.start();
                isTracking = true;
                logTrackingActivity('ğŸš€ å¼€å§‹ç”¨æˆ·è¡Œä¸ºè¿½è¸ª');
            } else {
                logTrackingActivity('âš ï¸ è¿½è¸ªå·²ç»åœ¨è¿è¡Œä¸­');
            }
        }
        
        function stopTracking() {
            if (isTracking) {
                userBehaviour.stop();
                isTracking = false;
                logTrackingActivity('â¹ï¸ åœæ­¢ç”¨æˆ·è¡Œä¸ºè¿½è¸ª');
            } else {
                logTrackingActivity('âš ï¸ è¿½è¸ªå°šæœªå¼€å§‹');
            }
        }
        
        function showTrackingResults() {
            const results = userBehaviour.showResult();
            logTrackingActivity('ğŸ“‹ å½“å‰è¿½è¸ªç»“æœ', results);
            
            // åœ¨æ–°çª—å£æ˜¾ç¤ºè¯¦ç»†ç»“æœ
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <html>
                    <head><title>ç”¨æˆ·è¡Œä¸ºè¿½è¸ªç»“æœ</title></head>
                    <body style="font-family: monospace; padding: 20px;">
                        <h2>ğŸ“Š ç”¨æˆ·è¡Œä¸ºè¿½è¸ªç»“æœ</h2>
                        <pre>${JSON.stringify(results, null, 2)}</pre>
                    </body>
                </html>
            `);
        }
        
        function clearTrackingLog() {
            document.getElementById('trackingLog').innerHTML = '<div>ğŸ“ æ—¥å¿—å·²æ¸…é™¤</div>';
        }
        
        function updateTrackingStats(results) {
            if (results.clicks) {
                document.getElementById('clickCount').textContent = results.clicks.clickCount;
            }
            if (results.mouseMovements) {
                document.getElementById('mouseCount').textContent = results.mouseMovements.length;
            }
            if (results.mouseScroll) {
                document.getElementById('scrollCount').textContent = results.mouseScroll.length;
            }
            if (results.keyboardActivities) {
                document.getElementById('keyCount').textContent = results.keyboardActivities.length;
            }
        }
        
        function logTrackingActivity(message, data = null) {
            const log = document.getElementById('trackingLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            
            if (data) {
                logEntry.innerHTML = `[${timestamp}] ${message}`;
            } else {
                logEntry.innerHTML = `[${timestamp}] ${message}`;
            }
            
            log.appendChild(logEntry);
            log.scrollTop = log.scrollHeight;
        }
        
        function testClick(buttonName) {
            logTrackingActivity(`ğŸ–±ï¸ ç‚¹å‡»äº† ${buttonName}`);
        }
        
        function handleFormSubmit(event) {
            event.preventDefault();
            logTrackingActivity('ğŸ“ è¡¨å•æäº¤äº‹ä»¶è¢«è§¦å‘');
        }
        
        function testInteraction() {
            logTrackingActivity('ğŸ¯ äº¤äº’æµ‹è¯•åŒºåŸŸè¢«ç‚¹å‡»');
        }
        
        // ==================== æ•°æ®èšåˆåŠŸèƒ½ ====================
        
        function generateMockEvents() {
            mockEvents = [];
            const eventTypes = ['click', 'mouseMovement', 'scroll', 'keyboardActivity', 'windowResize'];
            const baseTime = Date.now();
            
            // ç”Ÿæˆ50ä¸ªæ¨¡æ‹Ÿäº‹ä»¶
            for (let i = 0; i < 50; i++) {
                const eventType = eventTypes[Math.floor(Math.random() * eventTypes.length)];
                const timestamp = new Date(baseTime + i * 1000).toISOString();
                
                let eventData;
                switch (eventType) {
                    case 'click':
                        eventData = [
                            Math.floor(Math.random() * 800),
                            Math.floor(Math.random() * 600),
                            {
                                tagName: 'BUTTON',
                                id: 'test-btn-' + i,
                                className: 'btn btn-primary',
                                name: '',
                                value: '',
                                textContent: 'æµ‹è¯•æŒ‰é’®'
                            },
                            timestamp
                        ];
                        break;
                    case 'mouseMovement':
                        eventData = [
                            Math.floor(Math.random() * 800),
                            Math.floor(Math.random() * 600),
                            timestamp
                        ];
                        break;
                    case 'scroll':
                        eventData = [
                            Math.floor(Math.random() * 100),
                            Math.floor(Math.random() * 1000),
                            timestamp
                        ];
                        break;
                    case 'keyboardActivity':
                        const keys = ['a', 'b', 'c', 'Enter', 'Space', 'Backspace'];
                        eventData = [
                            keys[Math.floor(Math.random() * keys.length)],
                            {
                                tagName: 'INPUT',
                                id: 'test-input',
                                className: 'form-control',
                                name: 'test',
                                value: 'test value',
                                textContent: ''
                            },
                            timestamp
                        ];
                        break;
                    case 'windowResize':
                        eventData = [
                            800 + Math.floor(Math.random() * 400),
                            600 + Math.floor(Math.random() * 300),
                            timestamp
                        ];
                        break;
                }
                
                mockEvents.push({
                    type: eventType,
                    data: eventData,
                    timestamp: timestamp,
                    url: window.location.href,
                    userInfo: {
                        windowSize: [window.innerWidth, window.innerHeight],
                        appCodeName: navigator.appCodeName,
                        appName: navigator.appName,
                        vendor: navigator.vendor,
                        platform: navigator.platform,
                        userAgent: navigator.userAgent
                    }
                });
            }
            
            document.getElementById('eventCount').textContent = mockEvents.length;
            document.getElementById('rawEventsPreview').textContent = JSON.stringify(mockEvents.slice(0, 5), null, 2) + '\n...(æ˜¾ç¤ºå‰5ä¸ªäº‹ä»¶)';
        }
        
        function clearMockEvents() {
            mockEvents = [];
            aggregatedData = null;
            document.getElementById('eventCount').textContent = '0';
            document.getElementById('aggregateStatus').textContent = 'æœªèšåˆ';
            document.getElementById('rawEventsPreview').textContent = 'æš‚æ— äº‹ä»¶æ•°æ®';
            document.getElementById('aggregatedDataPreview').textContent = 'æš‚æ— èšåˆæ•°æ®';
        }
        
        function aggregateEvents() {
            if (mockEvents.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆæ¨¡æ‹Ÿäº‹ä»¶æ•°æ®');
                return;
            }
            
            try {
                // ä½¿ç”¨èšåˆå™¨å¤„ç†æ•°æ®
                if (typeof aggregateUserBehaviorData !== 'undefined') {
                    aggregatedData = aggregateUserBehaviorData(mockEvents, 'demo-session-' + Date.now());
                    document.getElementById('aggregateStatus').textContent = 'å·²èšåˆ';
                    document.getElementById('aggregatedDataPreview').textContent = JSON.stringify(aggregatedData, null, 2);
                } else {
                    // å¦‚æœèšåˆå™¨æœªåŠ è½½ï¼Œä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬
                    aggregatedData = {
                        userInfo: mockEvents[0].userInfo,
                        time: {
                            startTime: mockEvents[0].timestamp,
                            currentTime: new Date().toISOString(),
                            stopTime: mockEvents[mockEvents.length - 1].timestamp
                        },
                        clicks: {
                            clickCount: mockEvents.filter(e => e.type === 'click').length,
                            clickDetails: mockEvents.filter(e => e.type === 'click').map(e => e.data)
                        },
                        mouseMovements: mockEvents.filter(e => e.type === 'mouseMovement').map(e => e.data),
                        mouseScroll: mockEvents.filter(e => e.type === 'scroll').map(e => e.data),
                        keyboardActivities: mockEvents.filter(e => e.type === 'keyboardActivity').map(e => e.data),
                        navigationHistory: [],
                        formInteractions: [],
                        touchEvents: [],
                        mediaInteractions: [],
                        windowSizes: mockEvents.filter(e => e.type === 'windowResize').map(e => e.data),
                        visibilitychanges: []
                    };
                    document.getElementById('aggregateStatus').textContent = 'å·²èšåˆï¼ˆç®€åŒ–ç‰ˆï¼‰';
                    document.getElementById('aggregatedDataPreview').textContent = JSON.stringify(aggregatedData, null, 2);
                }
            } catch (error) {
                console.error('èšåˆæ•°æ®æ—¶å‡ºé”™:', error);
                alert('èšåˆæ•°æ®æ—¶å‡ºé”™: ' + error.message);
            }
        }
        
        function showAggregatedStats() {
            if (!aggregatedData) {
                alert('è¯·å…ˆèšåˆæ•°æ®');
                return;
            }
            
            const stats = {
                æ€»äº‹ä»¶æ•°: mockEvents.length,
                ç‚¹å‡»æ¬¡æ•°: aggregatedData.clicks.clickCount,
                é¼ æ ‡ç§»åŠ¨: aggregatedData.mouseMovements.length,
                æ»šåŠ¨æ¬¡æ•°: aggregatedData.mouseScroll.length,
                é”®ç›˜æ´»åŠ¨: aggregatedData.keyboardActivities.length,
                çª—å£è°ƒæ•´: aggregatedData.windowSizes.length
            };
            
            alert('èšåˆæ•°æ®ç»Ÿè®¡:\n' + JSON.stringify(stats, null, 2));
        }
        
        // ==================== è¡Œä¸ºå›æ”¾åŠŸèƒ½ ====================
        
        let recordingStartTime = null;
        let recordingTimer = null;
        
        function startRecording() {
            if (!isRecording) {
                // å¼€å§‹å½•åˆ¶
                userBehaviour.config({
                    userInfo: true,
                    clicks: true,
                    mouseMovement: true,
                    mouseMovementInterval: 0.1,
                    mouseScroll: true,
                    timeCount: true,
                    clearAfterProcess: false,
                    processTime: 1,
                    windowResize: true,
                    visibilitychange: true,
                    keyboardActivity: true,
                    pageNavigation: false,
                    formInteractions: true,
                    touchEvents: true,
                    audioVideoInteraction: true,
                    processData: function(results) {
                        currentRecordingData = results;
                        updateRecordingStats(results);
                    }
                });
                
                userBehaviour.start();
                isRecording = true;
                recordingStartTime = Date.now();
                
                // æ›´æ–°å½•åˆ¶æ—¶é•¿
                recordingTimer = setInterval(() => {
                    const duration = Math.floor((Date.now() - recordingStartTime) / 1000);
                    document.getElementById('recordingDuration').textContent = duration + 's';
                }, 1000);
                
                alert('ğŸ”´ å¼€å§‹å½•åˆ¶ç”¨æˆ·è¡Œä¸ºï¼Œè¯·åœ¨é¡µé¢ä¸Šè¿›è¡Œå„ç§æ“ä½œ...');
            } else {
                alert('âš ï¸ å½•åˆ¶å·²ç»åœ¨è¿›è¡Œä¸­');
            }
        }
        
        function stopRecording() {
            if (isRecording) {
                userBehaviour.stop();
                isRecording = false;
                
                if (recordingTimer) {
                    clearInterval(recordingTimer);
                    recordingTimer = null;
                }
                
                currentRecordingData = userBehaviour.showResult();
                alert('â¹ï¸ å½•åˆ¶å·²åœæ­¢ï¼Œå¯ä»¥å¼€å§‹æ’­æ”¾å›æ”¾');
            } else {
                alert('âš ï¸ å½•åˆ¶å°šæœªå¼€å§‹');
            }
        }
        
        function playRecording() {
            if (!currentRecordingData) {
                alert('è¯·å…ˆå½•åˆ¶ä¸€äº›ç”¨æˆ·è¡Œä¸ºæ•°æ®');
                return;
            }
            
            try {
                if (typeof userBehaviourPlayer !== 'undefined') {
                    const config = getPlayerConfig();
                    currentPlayer = userBehaviourPlayer;
                    currentPlayer.load(currentRecordingData, config);
                    alert('â–¶ï¸ å¼€å§‹æ’­æ”¾å›æ”¾ï¼Œè¯·è§‚å¯Ÿé¼ æ ‡è½¨è¿¹å’Œç‚¹å‡»æ•ˆæœ');
                } else {
                    alert('æ’­æ”¾å™¨æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥è„šæœ¬å¼•ç”¨');
                }
            } catch (error) {
                console.error('æ’­æ”¾å›æ”¾æ—¶å‡ºé”™:', error);
                alert('æ’­æ”¾å›æ”¾æ—¶å‡ºé”™: ' + error.message);
            }
        }
        
        function pausePlayback() {
            if (currentPlayer) {
                currentPlayer.pause();
            }
        }
        
        function stopPlayback() {
            if (currentPlayer) {
                currentPlayer.stop();
            }
        }
        
        function destroyPlayer() {
            if (currentPlayer) {
                currentPlayer.destroy();
                currentPlayer = null;
                alert('ğŸ—‘ï¸ æ’­æ”¾å™¨å·²æ¸…é™¤');
            }
        }
        
        function updatePlayerConfig() {
            // è¿™ä¸ªå‡½æ•°åœ¨æ’­æ”¾å™¨é…ç½®æ”¹å˜æ—¶è°ƒç”¨
            console.log('æ’­æ”¾å™¨é…ç½®å·²æ›´æ–°');
        }
        
        function getPlayerConfig() {
            return {
                playbackSpeed: parseFloat(document.getElementById('playbackSpeed').value),
                showMouseTrail: document.getElementById('showMouseTrail').checked,
                mouseTrailColor: '#ff4444',
                mouseTrailWidth: 2,
                showClickEffect: document.getElementById('showClickEffect').checked,
                clickEffectColor: '#00ff00',
                clickEffectSize: 20,
                showScrollIndicator: true,
                showKeyboardInput: true,
                controlPanelPosition: 'bottom',
                autoPlay: document.getElementById('autoPlay').checked,
                loop: false
            };
        }
        
        function updateRecordingStats(results) {
            if (results.clicks) {
                document.getElementById('recordedClicks').textContent = results.clicks.clickCount;
            }
            if (results.mouseMovements) {
                document.getElementById('recordedMoves').textContent = results.mouseMovements.length;
            }
            if (results.keyboardActivities) {
                document.getElementById('recordedKeys').textContent = results.keyboardActivities.length;
            }
        }
        
        function recordTestClick(area) {
            console.log('å½•åˆ¶æµ‹è¯•ç‚¹å‡»:', area);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¯ ç”¨æˆ·è¡Œä¸ºåˆ†æç»¼åˆæ¼”ç¤ºé¡µé¢å·²åŠ è½½');
            console.log('å¯ç”¨çš„åº“:', {
                userBehaviour: typeof userBehaviour !== 'undefined',
                aggregateUserBehaviorData: typeof aggregateUserBehaviorData !== 'undefined',
                userBehaviourPlayer: typeof userBehaviourPlayer !== 'undefined'
            });
        });
    </script>
</body>
</html>
